with input_source as (
    select * from {{ source('data_local', 'accidents_2014_2022') }}
),

renamed as (
    select
        BARDID as bard_id,
        AccidentCause1 as accident_cause1,
        AccidentCause2 as accident_cause2,
        AccidentCause3 as accident_cause3,
        AccidentEvent1 as accident_event1,
        AccidentEvent2 as accident_event2,
        AccidentEvent3 as accident_event3,
        AirTemperature as air_temperature,
        AVesselLoss as a_vessel_loss,
        Clear as clear,
        Cloudy as cloudy,
        CongestedWaters as congested_waters,
        CoordinatesConfidence as coordinates_confidence,
        County as county,
        Date as accident_date,
        DayNight as day_night,
        DayofWeek as day_of_week,
        EquipmentFailure as equipment_failure,
        Fog as fog,
        HazardousWaters as hazardous_waters,
        Hazy as hazy,
        LATITUDE as latitude,
        LONGITUDE as longitude,
        MachineryFailure as machinery_failure,
        NULL::BIGINT as meets_damage_threshold,
        NameOfBodyOfWater as name_of_body_of_water,
        NearestCityorTown as nearest_city_town,
        NumberDeaths as number_deaths,
        NumberInjured as number_injured,
        NumberVesselsInvolved as number_vessels_involved,
        NumberVesselsLost as number_vessels_lost,
        OtherAccidentCause as other_accident_cause,
        OtherAccidentEvent as other_accident_event,
        OtherEquipmentFailure as other_equipment_failure,
        OtherMachineryFailure as other_machinery_failure,
        Rain as rain,
        RedactedNarrative as redacted_narrative,
        Snow as snow,
        State as state,
        StrongCurrent as strong_current,
        Time as accident_time,
        TotalDamage as total_damage,
        Visibility as visibility,
        WaterConditions as water_conditions,
        WaterTemperature as water_temperature,
        Wind as wind,
        Year as year,
        'accidents_2014_2022' as data_source
    from input_source
)

select * from renamed
